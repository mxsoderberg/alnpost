@echo off
chcp 65001 >nul
title –°–±—Ä–æ—Å –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

cls
echo ================================
echo    –°–ë–†–û–° –ò –û–ë–ù–û–í–õ–ï–ù–ò–ï –ú–ê–¢–ï–†–ò–ê–õ–û–í
echo ================================

cd /d C:\Users\mx\Desktop\sturm\alnpost

echo.
echo –¢–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞: %cd%
echo.

echo –®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
echo.

:: –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∞–π–ª—ã –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–µ materials
echo –§–∞–π–ª—ã –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–µ materials:
dir materials\*.* | findstr /v ".gitkeep"
echo.

:: –°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤
set count=0
for %%f in (materials\*) do (
    if /i not "%%~nxf"==".gitkeep" (
        set /a count+=1
    )
)

if %count%==0 (
    echo –í–ù–ò–ú–ê–ù–ò–ï: –í –ø–∞–ø–∫–µ materials –Ω–µ—Ç —Ñ–∞–π–ª–æ–≤!
    echo –î–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º.
    echo.
    pause
    exit /b
)

echo –ù–∞–π–¥–µ–Ω–æ %count% –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.
echo.

echo –®–ê–ì 2: –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤...
echo.

:: –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã
echo –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤...
git add --all

:: –°–æ–∑–¥–∞–µ–º –∫–æ–º–º–∏—Ç
echo.
echo –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞...
for /f "tokens=2 delims==" %%a in ('wmic OS Get localdatetime /value') do set "dt=%%a"
set "timestamp=%dt:~6,2%.%dt:~4,2%.%dt:~0,4% %dt:~8,2%:%dt:~10,2%"

git commit -m "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ %timestamp% (%count% —Ñ–∞–π–ª–æ–≤)"

:: –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞ GitHub
echo.
echo –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ GitHub...
git push origin master

if %errorlevel%==0 (
    echo.
    echo –£–°–ü–ï–•! –§–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ GitHub.
    echo.
    echo –û—Ç–∫—Ä—ã—Ç–∏–µ Render –¥–ª—è –¥–µ–ø–ª–æ—è...
    start "" "https://dashboard.render.com"
    echo.
    echo –î–∞–ª—å–Ω–µ–π—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:
    echo 1. –ù–∞ Render –Ω–∞–∂–º–∏—Ç–µ "Manual Deploy"
    echo 2. –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –≤ Telegram –Ω–∞–∂–º–∏—Ç–µ "üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å"
    echo.
) else (
    echo.
    echo –û–®–ò–ë–ö–ê –∑–∞–≥—Ä—É–∑–∫–∏!
    echo –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.
)

echo.
pause