@echo off
chcp 65001 >nul
title –°–±—Ä–æ—Å –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

cls
echo ================================
echo    –°–ë–†–û–° –ò –û–ë–ù–û–í–õ–ï–ù–ò–ï –ú–ê–¢–ï–†–ò–ê–õ–û–í
echo ================================

cd /d C:\Users\mx\Desktop\sturm\alnpost

echo.
echo –¢–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞: %cd%
echo.

echo –®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ materials
echo.

:: –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∞–π–ª—ã –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–µ materials
echo –§–∞–π–ª—ã –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–µ materials:
dir materials\*.* | findstr /v ".gitkeep"
echo.

:: –°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤
set count=0
for %%f in (materials\*) do (
    if /i not "%%~nxf"==".gitkeep" (
        set /a count+=1
    )
)

if %count%==0 (
    echo –í–ù–ò–ú–ê–ù–ò–ï: –í –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–µ materials –Ω–µ—Ç —Ñ–∞–π–ª–æ–≤!
    echo –î–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–±—Ä–æ—Å–∞.
    echo.
    pause
    exit /b
)

echo –ù–∞–π–¥–µ–Ω–æ %count% –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.
echo.

echo –®–ê–ì 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–±—Ä–æ—Å—É
echo.

echo –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ:
echo 1. –û—á–∏—Å—Ç–∏—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –ø–∞–ø–æ–∫ (–Ω–∞ GitHub/Render)
echo 2. –ó–∞–≥—Ä—É–∑–∏—Ç –í–°–ï –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ materials
echo.

echo –í—ã —É–≤–µ—Ä–µ–Ω—ã? 
set /p confirm="–í–≤–µ–¥–∏—Ç–µ 'RESET' –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: "

if /i "%confirm%"=="RESET" (
    echo.
    echo –®–ê–ì 3: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏...
    echo.
    
    :: –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã (–≤–∫–ª—é—á–∞—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ)
    echo –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤...
    git add --all
    
    :: –°–æ–∑–¥–∞–µ–º –∫–æ–º–º–∏—Ç
    echo.
    echo –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞...
    for /f "tokens=2 delims==" %%a in ('wmic OS Get localdatetime /value') do set "dt=%%a"
    set "timestamp=%dt:~6,2%.%dt:~4,2%.%dt:~0,4% %dt:~8,2%:%dt:~10,2%"
    
    git commit -m "–ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ %timestamp% (–ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã: %count% —à—Ç.)"
    
    :: –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞ GitHub
    echo.
    echo –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ GitHub...
    git push origin master
    
    if %errorlevel%==0 (
        echo.
        echo –£–°–ü–ï–•! –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ GitHub.
        echo.
        echo –®–ê–ì 4: –û—Ç–∫—Ä—ã—Ç–∏–µ Render –¥–ª—è –¥–µ–ø–ª–æ—è...
        start "" "https://dashboard.render.com"
        echo.
        echo –î–∞–ª—å–Ω–µ–π—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:
        echo 1. –ù–∞ Render –Ω–∞–∂–º–∏—Ç–µ "Manual Deploy"
        echo 2. –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –≤ Telegram:
        echo    - –û—Ç–ø—Ä–∞–≤—å—Ç–µ /start
        echo    - –ù–∞–∂–º–∏—Ç–µ "üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å"
        echo    - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
        echo.
        echo –í–ê–ñ–ù–û: Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—Å—Ç–∏—Ç —Å–≤–æ–∏ –ø–∞–ø–∫–∏ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã
    ) else (
        echo.
        echo –û–®–ò–ë–ö–ê –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ GitHub!
        echo –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.
    )
) else (
    echo.
    echo –°–±—Ä–æ—Å –æ—Ç–º–µ–Ω–µ–Ω.
)

echo.
pause